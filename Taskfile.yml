version: "3"

tasks:
  backend.local:
    dir: ./deploy
    cmds:
      - go run cmd/www/main.go -config ./config/config.local.yaml
  # docker for local dev
  docker.up:
    dir: ./deploy
    preconditions:
      - test -f ./deploy/docker-compose.local.yaml
    cmds:
      - docker compose -f ./deploy/docker-compose.local.yaml up -d
  docker.down:
    dir: ./deploy
    preconditions:
      - test -f ./deploy/docker-compose.local.yaml
    cmds:
      - docker compose -f ./deploy/docker-compose.local.yaml down -v
  # sqlc
  sqlc.generate:
    dir: ./backend
    cmds:
      - sqlc generate
  # frontend
  frontend.dev:
    dir: ./frontend
    cmds:
      - npm run dev
